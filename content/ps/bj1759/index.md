---
title: "ë°±ì¤€ 1759 G5 ì•”í˜¸ ë§Œë“¤ê¸°"
date: 2025-03-11
toc: true

tags: ["backtracking", "combinatorics"]

mathjax: true

---

# í’€ì´

ì¡°ê±´ì— ë§ëŠ” ê¸¸ì´ $L$ì§œë¦¬ ì•”í˜¸ë¥¼ ê¸¸ì´ $C$ì˜ ë¬¸ì í›„ë³´êµ°ì—ì„œ ë½‘ì•„ ==ë¬´ì‹í•˜ê²Œ== ë§Œë“¤ë©´ ëœë‹¤.

ë¬´ì‹í•˜ê²Œ í•´ ë´ì•¼  $C$ê°œì—ì„œ $L$ê°œë¥¼ ë½‘ëŠ” ì¡°í•©ì˜ ìˆ˜ì´ë¯€ë¡œ, $\binom{C}{L}$ì´ë‹¤.

$3 \leq L \leq C \leq 15$ì´ë¯€ë¡œ,  ìµœì•…ì˜ ê²½ìš° $C=15$, $L=7$ì¼ë•Œ ì•½ 6000ë²ˆ ì •ë„ ê³„ì‚°ì„ í•˜ê²Œ ë  ê²ƒì´ê³  ì´ëŠ” ì œí•œ ì‹œê°„ 2ì´ˆë¥¼ ë„‰ë„‰íˆ í†µê³¼í•  ìˆ˜ ìˆëŠ” ì–‘ì´ë‹¤. [^1]

[^1]: ë°±íŠ¸ë˜í‚¹ì„ ì‚¬ìš©í•  ê²ƒì´ë¯€ë¡œ ì‹¤ì œë¡œëŠ” ë” ì¤„ì–´ë“¤ ê²ƒì´ë‹¤.

# ì•Œê³ ë¦¬ì¦˜

* ì‚¬ì „ìˆœìœ¼ë¡œ ì •ë ¬ë˜ì–´ ìˆì–´ì•¼ í•˜ë¯€ë¡œ ë¬¸ì í›„ë³´êµ° `letters`ëŠ” ì¼ë‹¨ ì •ë ¬ë˜ì–´ì•¼ í•œë‹¤.
* `letters`ì˜ ì™¼ìª½ë¶€í„° ìˆœíšŒí•˜ë©´ì„œ í•˜ë‚˜ì”© ë½‘ì•„ ë¶™ì—¬ ì•”í˜¸ë¬¸ì„ ë§Œë“¤ì–´ ë³´ì (ì¬ê·€)
  * ë¬¸ì œì˜ ì¡°ê±´ì¸ ììŒ 1ê°œ ì´ìƒ, ëª¨ìŒ 2ê°œ ì´ìƒì„ ë§Œì¡±í•˜ì§€ ì•Šìœ¼ë©´ ìœ ë§í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ë°”ë¡œ í•´ë‹¹ ë¶„ê¸°ë¥¼ ê°€ì§€ì¹˜ê¸°í•œë‹¤.
  * ì›í•˜ëŠ” ì•”í˜¸ ê¸¸ì´ì— ë„ë‹¬í•œ ê²½ìš° ì¶œë ¥í•˜ê³  ë¶„ê¸°ë¥¼ ì¢…ë£Œí•œë‹¤.

# ì½”ë“œ

{{< hls source="assets/code.cc" syntax="cpp" >}}

# ì˜ëª»ëœ í’€ì´

ì¢€ ë¨¸ë¦¬ë¥¼ êµ´ë ¤ì„œ `next_permutation`ì„ ì´ìš©í•˜ë ¤ê³  í–ˆëŠ”ë° íŒ¨ì°©ì´ì—ˆë‹¤.

ì½”ë“œë¥¼ ì˜¤íˆë ¤ ë³µì¡í•˜ê²Œë§Œ ë§Œë“œëŠ” ë“¯ í•˜ë‹¤. ê²Œë‹¤ê°€ í†µê³¼ë„ ëª» í•¨.

*ì¶œë ¥ ì´ˆê³¼* ê°€ ëœ¨ëŠ”ë°, ì´ìœ ë¥¼ ë„í†µ ëª¨ë¥´ê² ë‹¤. (ì •ë§ í•˜ë£¨ ì¢…ì¼ ê³ ë¯¼í•´ ë´ë„ ëª¨ë¥´ê² ë‹¤.)

ëˆ„êµ¬ ì•„ëŠ” ë¶„ ìˆìœ¼ë©´, ì–˜ê¸° í•´ì£¼ì‹œê¸¸. ğŸ˜­ <sup>ë¬¼ë¡  GPT ì—ê²Œë„ ë¬¼ì–´ë³´ì•˜ìœ¼ë‚˜ ... ì–˜ë„ ì˜ ë‹µì„ ëª»í•œë‹¤...</sup>

{{< hls source="assets/fcode.cc" syntax="cpp" >}}

# ê¸°íƒ€

## C++ STL ìˆœì—´

`std::next_permutation`ê³¼ `std::prev_permutation`ì„ ì´ìš©í•˜ë©´ í¸ë¦¬í•˜ê²Œ ìˆœì—´ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.

### $_nP_n$ êµ¬í•˜ê¸°

ì˜ˆë¥¼ ë“¤ì–´ ì–´ë–¤ ìˆ˜ì—´ `{2, 1, 3}`ì˜ **ì‚¬ì „ìˆœ (ì˜¤ë¦„ì°¨ìˆœ) ìˆœì—´**ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

```{lineNos=false}
{1, 2, 3} (ì‚¬ì „ìˆœìœ¼ë¡œ ê°€ì¥ ì‘ë‹¤)
{1, 3, 2}
{2, 1, 3} <-- ì—¬ê¸°!
{2, 3, 1}
{3, 1, 2}
{3, 2, 1} (ì‚¬ì „ìˆœìœ¼ë¡œ ê°€ì¥ í¬ë‹¤)
```

`std::next_permutation`ê³¼ `std::prev_permutation`ì€ ì…ë ¥ë°›ì€  ë²”ìœ„ì˜ ìˆ˜ì—´ì„ ì‚¬ì „ìˆœìœ¼ë¡œ ë‹¤ìŒ ìˆœì—´, í˜¹ì€ ì´ì „ ìˆœì—´ë¡œ ë³€ê²½í•˜ë ¤ê³  í•˜ë©° ë³€ê²½ì— ì„±ê³µí•œ ê²½ìš° `true`ë¥¼ ë°˜í™˜í•œë‹¤. 

ë§Œì¼ ë” ì´ìƒ ë‹¤ìŒ/ì´ì „ ìˆœì—´ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° `false`ë¥¼ ë°˜í™˜í•œë‹¤.

[ì£¼ì˜] `false`ë¥¼ ë°˜í™˜í•˜ë”ë¼ë„, ì „ë‹¬ë°›ì€ ë²”ìœ„ë¥¼ ë³€ê²½í•œë‹¤:
* `{3, 2, 1}`ì—ë‹¤ `std::next_permutation`ì„ í˜¸ì¶œí•˜ë©´ `false`ë¥¼ ë°˜í™˜í•˜ê³  `{1, 2, 3}`ì´ ëœë‹¤.
* `{1, 2, 3}`ì—ë‹¤ `std::prev_permutation`ì„ í˜¸ì¶œí•˜ë©´ `false`ë¥¼ ë°˜í™˜í•˜ê³  `{3, 2, 1}`ì´ ëœë‹¤.

ë³´í†µ ë‹¤ìŒì²˜ëŸ¼ Do-While ë¬¸ê³¼ í•¨ê»˜ ì“´ë‹¤.

```cpp{lineNos=false}
std::vector<int> seq { 2, 1, 3 };

do {
  for (const auto& e: seq) cout << e << ' ';
  cout << '\n';
} while (std::next_permutation(seq.begin(), seq.end()));

// ì´ ì‹œì ì—ì„œ seqì€ 1, 2, 3

// 3, 2, 1ë¡œ ë§Œë“¤ì–´ì¤Œ
std::prev_permutation(seq.begin(), seq.end());

do {
  for (const auto& e: seq) cout << e << ' ';
  cout << '\n';
} while (std::prev_permutation(seq.begin(), seq.end()));

// ì´ ì‹œì ì—ì„œ seqì€ 3, 2, 1
```

### $_nP_r$ êµ¬í•˜ê¸°

$n$ê°œ ì¤‘ì— $r$ê°œë¥¼ ë½‘ê³  ì‹¶ì€ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ í•˜ë©´ ì•ˆëœë‹¤!

ë‹¤ìŒì€ ìˆ˜ì—´ `{2, 1, 3}`ì—ì„œ 2ê°œì˜ ì›ì†Œë¥¼ ìˆœì„œ ìˆì´ ë½‘ëŠ” ì˜ˆì œì´ë‹¤.

```cpp{lineNos=false}
std::vector<int> seq { 2, 1, 3 };

do {
  for (int i = 0; i < 2; ++i) {
    cout << seq[i] << ' ';
  }
  cout << '\n';
} while(std::next_permutation(seq.begin(), seq.end())); 
```

ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```{lineNos=false}
{{2, 1}, 3} <-- ì‹œì‘!
{{2, 3}, 1}
{{3, 1}, 2}
{{3, 2}, 1} <-- ë!
---
{{1, 2}, 3} <-- ê·¸ëŸ¬ë‚˜, ì‚¬ì‹¤ ëì´ ì•„ë‹ˆì—ˆë‹¤...
...
```

ì´ë ‡ê²Œ ì •ë ¬ë˜ì§€ ì•Šì€ ìˆ˜ì—´ì—ì„œ ë½‘ìœ¼ë ¤ê³  í•˜ë©´, `std::next_permutation`ì´ ìˆœì—´ ëì— ë„ë‹¬í–ˆë‹¤ê³  íŒë‹¨í•´ë²„ë¦¬ê³  ë”ì´ìƒ ì§„í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤. 
ê·¸ë˜ì„œ ì •ë ¬ë˜ì§€ ì•Šì€ ìˆ˜ì—´ì—ì„œëŠ” ì›í•˜ëŠ” ëª¨ë“  ìŒì„ ë½‘ì„ ìˆ˜ê°€ ì—†ë‹¤.

ì´ê±¸ í•´ê²°í•˜ëŠ” ë²•ì€ ë‘ ê°€ì§€ê°€ ìˆëŠ”ë°,
1. ìˆ˜ì—´ ìì²´ë¥¼ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•œë‹¤.
2. ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê¸° ì‹«ìœ¼ë©´, **ì¸ë±ìŠ¤ë¥¼ ê¸°ì–µí•˜ëŠ” ìˆ˜ì—´**ì„ ìƒˆë¡œ ë§Œë“ ë‹¤.

1ë²ˆì´ì•¼ ì‰¬ìš°ë‹ˆ ë„˜ì–´ê°€ë„, 2ë²ˆì˜ ì˜ˆëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```cpp{lineNos=false}
std::vector<int> seq { 2, 1, 3 };
std::vector<int> indices(seq.size());
std::iota(indices.begin(), indices.end(), 0); // { 0, 1, 2 }

do {
  for (int i = 0; i < 2; ++i) {
    cout << seq[indices[i]] << ' ';
  }
  cout << '\n';
} while(std::next_permutation(indices.begin(), indices.end())); 
```

ì¶œë ¥ì€ ì•„ë˜ì™€ ê°™ë‹¤. (ë’¤ëŠ” ì¸ë±ìŠ¤ì˜ ìˆœì—´ì´ë‹¤)

```{lineNos=false}
{{2, 1}, 3} - {{0, 1}, 2} <-- ì‹œì‘
{{2, 3}, 1} - {{0, 2}, 1}
{{1, 2}, 3} - {{1, 0}, 2}
{{1, 3}, 2} - {{1, 2}, 0}
{{3, 2}, 1} - {{2, 0}, 1}
{{3, 1}, 2} - {{2, 1}, 0} <-- ë
```

ì¸ë±ìŠ¤ì²˜ëŸ¼ ì¶”ê°€ì ì¸ ì •ë³´ë¥¼ ìˆœì—´ì— ëŒë¦¬ëŠ” í…Œí¬ë‹‰ì´ ê½¤ ê´œì°®ë‹¤. ì¡°í•©ì„ êµ¬í˜„í•  ë•Œì—ë„ ì‚¬ìš©ëœë‹¤.

## ì¡°í•©ì€ ì–´ë–»ê²Œ?

$_nP_r$ì—ì„œ `indices` ë°°ì—´ì„ ì¶”ê°€ ê´€ë¦¬í–ˆë“¯ì´, ì´ë²ˆì—ëŠ” `mask`ë¼ëŠ” ì •ë³´ë¥¼ ê´€ë¦¬í•´ ë³¸ë‹¤.

ì½”ë“œë¡œ ì´í•´í•˜ëŠ” ê²ƒì´ ë” ë¹ ë¥´ë‹¤: ìˆ˜ì—´ `{2, 1, 3}`ì—ì„œ 2ê°œë¥¼ ë½‘ì•„ ì¡°í•©í•˜ëŠ” ì˜ˆì œì´ë‹¤.

```cpp{lineNos=false}
std::vector<int> seq {2, 1, 3};
std::vector<bool> mask(seq.size(), false);
std::fill(mask.rbegin(), mask.rbegin() + 2, true);

do {
  for (int i = 0; i < seq.size(); ++i) {
    if (!mask[i]) continue;

    cout << seq[i] << ' ';
  }
  cout << '\n';
} while (std::next_permutation(mask.begin(), mask.end()));
```

`mask`ë¡œ ì¡°í•©ì—ì„œ ë½‘ì„ ê°¯ìˆ˜ë§Œí¼ `true`ë¡œ ë§ˆí‚¹í•´ì£¼ì.
í•µì‹¬ì€ ë’¤ì—ì„œë¶€í„° ë§ˆí‚¹í•˜ì—¬ ì˜¤ë¦„ì°¨ìˆœì„ ìœ ì§€í•˜ëŠ” ê²ƒ. (ì•ì—ì„œë¶€í„° ë§ˆí‚¹í•œ í›„ `std::reverse`ë¡œ ë’¤ì§‘ì–´ ì£¼ì–´ë„ ì¢‹ë‹¤.)

`mask` ë°°ì—´ì„ ìˆœì—´ë¡œ ëŒë¦° í›„, `mask`ê°€ ìˆëŠ” ë¶€ë¶„ë§Œ ì¶œë ¥í•˜ë©´ ì¡°í•©ì´ ì™„ì„±ëœë‹¤. 

êµ¬ì²´ì ìœ¼ë¡œ ì¶œë ¥ì€ ë‹¤ìŒì²˜ëŸ¼ ì‘ë™í•œë‹¤:
```{lineNos=false}
{ 2,  [1], [3]} - {0, 1, 1}
{[2],  1,  [3]} - {1, 0, 1}
{[2], [1],  3 } - {1, 1, 0}
```

## ë°± íŠ¸ë˜í‚¹

ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ë¥¼ íƒìƒ‰í•˜ë©´ì„œë„, ë¶ˆí•„ìš”í•œ ê²½ë¡œë¥¼ ê°€ì§€ì¹˜ê¸°(í”„ë£¨ë‹)í•˜ì—¬ íš¨ìœ¨ì ìœ¼ë¡œ íƒìƒ‰í•˜ëŠ” ê¸°ë²•ì´ë‹¤.

ë³´í†µ ì¬ê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ì§‘í•©ì„ êµ¬ì„±í•˜ê³ , ì í•©í•˜ì§€ ì•Šì€ ê²½ìš°ë¥¼ ë°°ì œí•œë‹¤.

ë°±íŠ¸ë˜í‚¹ì€ ë³´í†µ **ê¹Šì´ ìš°ì„  íƒìƒ‰**ì„ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤.

ê¸°ë³¸ ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
* íƒìƒ‰ ì‹œì‘
* í˜„ì¬ ìƒíƒœê°€ ìœ ë§í•œì§€ í™•ì¸.
  * ìœ ë§í•˜ì§€ ì•Šë‹¤ë©´ (ì• ì´ˆì— ë¶ˆê°€ëŠ¥í•œ ê²½ë¡œë¼ë©´) ë” ê¹Šì´ íƒìƒ‰í•˜ì§€ ì•Šê³  **ê°€ì§€ì¹˜ê¸°**
* ëª©í‘œí•œ ìƒíƒœì— ë„ë‹¬í•˜ë©´ í•´ë¥¼ ì €ì¥í•˜ê±°ë‚˜ ì¶œë ¥
* ê°€ëŠ¥í•œ ëª¨ë“  ì„ íƒì§€ë¥¼ ì‹œë„í•œ í›„, ì´ì „ ìƒíƒœë¡œ ë˜ëŒì•„ê°€ê¸° (**ë°±íŠ¸ë™**)
  * ë˜ëŒì•„ê°€ë©´ì„œ ë‹¤ë¥¸ ì„ íƒì§€ë¥¼ íƒìƒ‰í•œë‹¤.

ì¦‰, í•œ ê²½ë¡œë¥¼ ë”°ë¼ íƒìƒ‰í•˜ë‹¤ê°€ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ë°”ë¡œ ë˜ëŒì•„ê°€ëŠ” ê²ƒì´ ë°±íŠ¸ë˜í‚¹ì´ë‹¤.

DFSëŠ” ë‹¨ìˆœíˆ ëª¨ë“  ê²½ë¡œë¥¼ íƒìƒ‰í•˜ë‚˜, ë°±íŠ¸ë˜í‚¹ì€ ìœ ë§í•˜ì§€ ì•Šì€ ê²½ë¡œì— ëŒ€í•œ íƒìƒ‰ì„ ë¹ ë¥´ê²Œ í¬ê¸°í•˜ì—¬ íƒìƒ‰ëŸ‰ì„ ì¤„ì´ëŠ” ë°ì— ê·¸ ì˜ì˜ê°€ ìˆë‹¤.

### [ì˜ˆì œ] ë°± íŠ¸ë˜í‚¹ìœ¼ë¡œ ìˆœì—´ êµ¬í˜„

ë°± íŠ¸ë˜í‚¹ì„ ì´ìš©í•´ ìˆœì—´ì„ ì§ì ‘ êµ¬í˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

```cpp
#include <iostream>
#include <vector>

using namespace std;

void _perm_dfs(const vector<int>& seq, int size, vector<int>& path, vector<bool>& used) {
  if (path.size() == size) {
    for (const auto& e: path) {
      cout << e << ' ';
    }
    cout << '\n';
    return;
  }

  for (int i = 0; i < used.size(); ++i) {
    if (used[i]) continue;

    path.push_back(seq[i]);
    used[i] = true;

    _perm_dfs(seq, size, path, used);

    path.pop_back();
    used[i] = false;
  }
}

void perm(const vector<int>& seq, int size) {
  vector<int> path; path.reserve(size);
  vector<bool> used(seq.size(), false);

  _perm_dfs(seq, size, path, used);
}

int main() {
  perm({1, 2, 3}, 2);
}
```

### [ì˜ˆì œ] ë°± íŠ¸ë˜í‚¹ìœ¼ë¡œ ì¡°í•© êµ¬í˜„

ì¡°í•©ë„ ì•„ë˜ì²˜ëŸ¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

```cpp
void _comb_dfs(const vector<int>& seq, int size, vector<int>& path, int start) {
  if (path.size() == size) {
    for (const auto& e: path) {
      cout << e << ' ';
    }
    cout << '\n';
    return;
  }

  for (int i = start; i < seq.size(); ++i) {
    path.push_back(seq[i]);
    _comb_dfs(seq, size, path, i + 1);
    path.pop_back();
  }
}

void comb(const vector<int>& seq, int size) {
  vector<int> path; path.reserve(size);

  _comb_dfs(seq, size, path, 0);
}

int main() {
  comb({ 1, 2, 3, 4, 5 }, 3);
}
```